<!DOCTYPE html>
<html lang="lt">
<head>
<meta charset="UTF-8">
<title>SocialUp ‚Äì socialinƒós veiklos</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Segoe UI,Arial,sans-serif;
  background:url("https://images.unsplash.com/photo-1529156069898-49953e39b3ac") center/cover fixed;
  color:white;
}
.container{
  max-width:1100px;
  margin:40px auto;
  background:rgba(0,0,0,.9);
  padding:40px;
  border-radius:20px;
}
h1,h2,h3{text-align:center;color:#ffd700;}
input,button{
  width:100%;
  padding:14px;
  margin-bottom:12px;
  border:none;
  border-radius:10px;
  font-size:16px;
}
button{
  font-weight:bold;
  cursor:pointer;
  transition: all 0.3s ease;
}
button:hover{transform:scale(1.05);}
.logout{background:#e74c3c;color:white;margin-top:20px;}
.reg{background:#27ae60;color:white;}
.unreg{background:#c0392b;color:white;}
.activities{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(300px,1fr));
  gap:20px;
}
.card{
  background:rgba(255,255,255,.1);
  padding:20px;
  border-radius:15px;
  display:flex;
  flex-direction:column;
  gap:10px;
  box-shadow:0 8px 20px rgba(0,0,0,0.5);
  transition:0.3s;
}
.card:hover{transform:translateY(-5px);}
.card h3{margin:0;color:#ffd700;}
.card a{color:#00d4ff;text-decoration:none;}
.count{font-size:14px;color:#eee;}
.label{font-weight:bold;}
.about-me{
  display:flex;
  gap:30px;
  margin-top:60px;
  padding:30px;
  background:rgba(0,0,0,.6);
  border-radius:20px;
  align-items:center;
}
.about-me img{width:200px;border-radius:20px;border:3px solid #ffd700;}
@media(max-width:768px){
  .about-me{flex-direction:column;text-align:center;}
}
</style>
</head>
<body>
<div class="container">

  <!-- LOGIN -->
  <div id="loginSection">
    <h1>Prisijungimas</h1>

    <h3>Asmuo</h3>
    <input type="text" id="username" placeholder="Vardas">
    <input type="email" id="userEmail" placeholder="El. pa≈°tas">
    <button onclick="login()">Prisijungti</button>

    <h3>Organizacija</h3>
    <input type="text" id="orgName" placeholder="Organizacijos pavadinimas">
    <input type="text" id="orgCode" placeholder="Specialus kodas (pvz. ORG-123)">
    <button onclick="orgLogin()">Prisijungti kaip organizacija</button>
  </div>

  <!-- VEIKLOS -->
  <div id="activitiesSection" style="display:none;">
    <h1>Socialinƒós veiklos</h1>

    <div id="addActivityForm" style="display:none;">
      <h3>Pridƒóti naujƒÖ veiklƒÖ</h3>
      <input type="text" id="newName" placeholder="Veiklos pavadinimas">
      <input type="number" id="newHours" placeholder="Valand≈≥ skaiƒçius">
      <input type="text" id="newDate" placeholder="Data (pvz. 2026-02-30)">
      <input type="text" id="newDesc" placeholder="Apra≈°ymas">
      <input type="text" id="newLocation" placeholder="≈Ωemƒólapio nuoroda">
      <button onclick="addActivity()">Pridƒóti veiklƒÖ</button>
    </div>

    <div class="activities" id="activitiesContainer"></div>
    <button class="logout" onclick="logout()">Atsijungti</button>
  </div>

  <!-- APIE MANE -->
  <div class="about-me">
    <img src="apie-mane.jpg" alt="A≈° savanoriaujant">
    <div>
      <h2>Apie mane</h2>
      <p>
        Sveiki, a≈° esu Benediktas. Tai yra mano mokyklos projektas, taƒçiau noriu jƒØ praplƒósti ƒØ socialinƒØ projektƒÖ. ≈†io puslapio tikslas ‚Äì padƒóti ≈æmonƒóms lengviau rasti socialines veiklas ir savanorystƒós galimybes. ≈†iuo metu ie≈°kau partneri≈≥ ir organizacij≈≥, kurios norƒót≈≥ prisidƒóti prie ≈°ios idƒójos vystymo.
      </p>
    </div>
  </div>

</div>

<script>
// GLOBALS
let activities = []; // visos veiklos laikomos ƒçia

// LOGIN ASMUO
function login(){
  const name = username.value.trim();
  const email = userEmail.value.trim();
  if(!name || !email) return;
  localStorage.setItem("user", JSON.stringify({name,email}));
  loginSection.style.display = "none";
  activitiesSection.style.display = "block";
  loadAllActivities();
  renderActivities();
}

// LOGIN ORGANIZACIJA
function orgLogin(){
  const name = orgName.value.trim();
  const code = orgCode.value.trim();
  if(!name || !code) return;
  if(!code.startsWith("ORG-")) return;
  localStorage.setItem("org", JSON.stringify({name,code}));
  loginSection.style.display = "none";
  activitiesSection.style.display = "block";
  document.getElementById("addActivityForm").style.display = "block";
  loadOrgActivities(code);
  renderActivities();
}

// LOGOUT
function logout(){
  localStorage.clear();
  loginSection.style.display = "block";
  activitiesSection.style.display = "none";
}

// ADD ACTIVITY (tik organizacija)
function addActivity(){
  const org = JSON.parse(localStorage.getItem("org"));
  if(!org) return;

  const newAct = {
    id: Date.now(), // unikalus id
    name: document.getElementById("newName").value,
    hours: document.getElementById("newHours").value,
    date: document.getElementById("newDate").value,
    description: document.getElementById("newDesc").value,
    location: document.getElementById("newLocation").value
  };

  // ƒÆkeliame tik tos organizacijos veiklas
  let orgActivities = JSON.parse(localStorage.getItem(org.code)) || [];
  orgActivities.push(newAct);
  localStorage.setItem(org.code, JSON.stringify(orgActivities));

  loadAllActivities();
  renderActivities();
}

// ƒÆkelti VISAS veiklas i≈° vis≈≥ organizacij≈≥
function loadAllActivities(){
  activities = [];
  for(let i=0;i<localStorage.length;i++){
    const key = localStorage.key(i);
    if(key.startsWith("ORG-")){
      const orgActs = JSON.parse(localStorage.getItem(key));
      activities = activities.concat(orgActs);
    }
  }
}

// ƒÆkelti TIK tos organizacijos veiklas
function loadOrgActivities(code){
  const orgActs = JSON.parse(localStorage.getItem(code)) || [];
  // i≈°valome senas veiklas i≈° global activities
  loadAllActivities();
}

// TOGGLE REGISTRACIJA (tik asmuo)
function toggleRegistration(activityId){
  const user = JSON.parse(localStorage.getItem("user"));
  if(!user) return;
  let regs = JSON.parse(localStorage.getItem("registrations")) || {};
  if(!regs[activityId]) regs[activityId] = [];
  if(regs[activityId].includes(user.name)){
    regs[activityId] = regs[activityId].filter(u => u !== user.name);
  } else {
    regs[activityId].push(user.name);
  }
  localStorage.setItem("registrations", JSON.stringify(regs));
  renderActivities();
}

// RENDER ACTIVITIES
function renderActivities(){
  const regs = JSON.parse(localStorage.getItem("registrations")) || {};
  activitiesContainer.innerHTML = "";
  activities.forEach(a=>{
    const user = JSON.parse(localStorage.getItem("user"));
    const registered = user && regs[a.id] && regs[a.id].includes(user.name);
    const count = regs[a.id] ? regs[a.id].length : 0;
    const div=document.createElement("div");
    div.className="card";
    div.innerHTML=`
      <h3>${a.name}</h3>
      <p><span class="label">Valandos:</span> ${a.hours}</p>
      <p><span class="label">Data / Kada:</span> ${a.date}</p>
      <p>${a.description}</p>
      <p class="count">U≈æsiregistravusi≈≥: ${count}</p>
      <a href="${a.location}" target="_blank">üìç ≈Ωemƒólapis</a>
      ${user ? `<button class="${registered?'unreg':'reg'}"
        onclick="toggleRegistration(${a.id})">
        ${registered?'Atsiregistruoti':'U≈æsiregistruoti'}
      </button>` : ""}
    `;
    activitiesContainer.appendChild(div);
  });
}

// PATIKRINAME, AR PRISIJUNGƒòS
const user = JSON.parse(localStorage.getItem("user"));
const org = JSON.parse(localStorage.getItem("org"));
if(user){
  loginSection.style.display="none";
  activitiesSection.style.display="block";
  loadAllActivities();
  renderActivities();
}
if(org){
  loginSection.style.display="none";
  activitiesSection.style.display="block";
  document.getElementById("addActivityForm").style.display="block";
  loadOrgActivities(org.code);
  renderActivities();
}
</script>
</body>
</html>
