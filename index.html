<!DOCTYPE html>
<html lang="lt">
<head>
  <meta charset="UTF-8">
  <title>SocialUp</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">

  <!-- LOGIN -->
  <div id="loginSection">
    <h1>Prisijungimas</h1>
    <input type="text" id="loginInput" placeholder="Vardas arba ORG-123">
    <button onclick="login()">Prisijungti</button>
  </div>

  <!-- ORGANIZACIJA -->
  <div id="orgSection" style="display:none;">
    <h1>Organizacijos veiklos</h1>

    <div class="card">
      <input id="title" placeholder="Veiklos pavadinimas">
      <input id="date" type="date">
      <input id="hours" type="number" placeholder="Valandos">
      <button onclick="addActivity()">PridÄ—ti veiklÄ…</button>
    </div>

    <div id="orgActivities" class="activities"></div>
    <button class="logout" onclick="logout()">Atsijungti</button>
  </div>

  <!-- ASMUO -->
  <div id="userSection" style="display:none;">
    <h1>Galimos veiklos</h1>
    <div id="userActivities" class="activities"></div>
    <button class="logout" onclick="logout()">Atsijungti</button>
  </div>

  <!-- APIE MANE -->
  <div class="about-me">
    <div>
      <h2>Apie mane</h2>
      <p><b>Sveiki, aÅ¡ esu Benediktas.</b></p>
      <p>
        Tai yra mano mokyklos projektas, taÄiau noriu jÄ¯ praplÄ—sti Ä¯
        socialinÄ¯ projektÄ…. Å io puslapio tikslas â€“ padÄ—ti Å¾monÄ—ms
        lengviau rasti socialines veiklas ir savanorystÄ—s galimybes.
      </p>
      <p>
        Å iuo metu ieÅ¡kau partneriÅ³ ir organizacijÅ³, kurios norÄ—tÅ³
        prisidÄ—ti prie Å¡ios idÄ—jos vystymo.
      </p>
    </div>
  </div>

</div>

<script>
let currentUser = localStorage.getItem("user");
let role = localStorage.getItem("role");
let orgCode = localStorage.getItem("orgCode");

function login(){
  const val = loginInput.value.trim();
  if(!val) return alert("Ä®vesk duomenis");

  if(val.startsWith("ORG-")){
    localStorage.setItem("role","org");
    localStorage.setItem("orgCode",val);
  } else {
    localStorage.setItem("role","user");
    localStorage.setItem("user",val);
  }
  location.reload();
}

function logout(){
  localStorage.clear();
  location.reload();
}

function getOrgActivities(){
  return JSON.parse(localStorage.getItem("activities_"+orgCode)) || [];
}

function saveOrgActivities(arr){
  localStorage.setItem("activities_"+orgCode, JSON.stringify(arr));
}

function addActivity(){
  const acts = getOrgActivities();
  acts.push({
    id: Date.now(),
    title: title.value,
    date: date.value,
    hours: hours.value,
    regs: []
  });
  saveOrgActivities(acts);
  renderOrg();
}

function renderOrg(){
  orgActivities.innerHTML="";
  getOrgActivities().forEach(a=>{
    orgActivities.innerHTML+=`
      <div class="card">
        <h3>${a.title}</h3>
        <p>ğŸ“… ${a.date}</p>
        <p>â±ï¸ ${a.hours} val.</p>
        <p>ğŸ‘¥ UÅ¾siregistravo: ${a.regs.length}</p>
      </div>`;
  });
}

function renderUser(){
  userActivities.innerHTML="";
  Object.keys(localStorage).forEach(k=>{
    if(k.startsWith("activities_")){
      JSON.parse(localStorage.getItem(k)).forEach(a=>{
        userActivities.innerHTML+=`
        <div class="card">
          <h3>${a.title}</h3>
          <p>ğŸ“… ${a.date}</p>
          <p>â±ï¸ ${a.hours} val.</p>
          <p>ğŸ‘¥ ${a.regs.length} Å¾moniÅ³</p>
          <button onclick="register('${k}',${a.id})">UÅ¾siregistruoti</button>
        </div>`;
      });
    }
  });
}

function register(orgKey,id){
  let acts = JSON.parse(localStorage.getItem(orgKey));
  let u = localStorage.getItem("user");
  acts.find(a=>a.id===id).regs.push(u);
  localStorage.setItem(orgKey,JSON.stringify(acts));
  renderUser();
}

if(role==="org"){
  loginSection.style.display="none";
  orgSection.style.display="block";
  renderOrg();
}
if(role==="user"){
  loginSection.style.display="none";
  userSection.style.display="block";
  renderUser();
}
</script>

</body>
</html>
